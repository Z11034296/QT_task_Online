{% extends 'index.html' %}
{% block page-content %}

    <style>
        body {
            background-color: #eeedef;
            padding-right:0!important;
        }
        table {
            table-layout:  fixed;
        }
        th{
            text-align: center;
        }

    </style>
    {% if user.is_authenticated %}
        <div class="panel panel-primary ">
            <div class="panel-heading ">
                <h2 class="panel-title">All Testcase</h2>
            </div>
            <div class="panel-body ">
                <button class="btn btn-success pull-right" data-toggle="modal"
                        onclick="window.location.href='add_case'">新增
                </button>
                <button class="btn btn-success pull-right" data-toggle="modal"
                        onclick="window.location.href='upload_files'">批量
                </button>



            <table class = "table table-striped table-bordered">
                <thead class="">
                <tr>

                    <th width="10%">Case_Id</th>
                    <th>Case_name</th>
                    <th width="5%">Function</th>
                    <th width="5%">Test_Items</th>
                    <th width="20%">Procedure</th>
                    <th width="20%">Pass_Critearia</th>
                    <th width="6%">Attend_Time</th>
                    <th width="5%">Status</th>
                    <th>Case_Note</th>
                    <th width="5%">操作</th>
                    <th width="5%">附件</th>
                </tr>
                </thead>
                <tbody>

                {%  for cases in case_list %}
                    <tr>
                    <td style="text-align: center;vertical-align: middle">{{ cases.case_id }}</td>
                    <td style="white-space:pre-wrap; word-break: unset; vertical-align: middle"><a href="case_moreinfo/{{ cases.id }}" data-toggle="modal" data-target="#case_moreinfo">{{ cases.case_name }}</a></td>
                    <td style="text-align: center;vertical-align: middle">{{ cases.function.function_name }}</td>
                    <td style="text-align: center;vertical-align: middle">{{ cases.sheet.sheet_name}}</td>
                    <td class="xtd">{{ cases.procedure|linebreaksbr }}</td>
                    <td class="xtd">{{ cases.pass_criteria|linebreaksbr }}</td>
                    <td style="text-align: center;vertical-align: middle">{{ cases.attend_time }}</td>
                    <td style="text-align: center;vertical-align: middle">
                        {% if cases.case_status == '1'  %}
                            open
                        {% elif cases.case_status == '2'  %}
                            closed
                        {% endif %}
                    </td>
                    <td class="xtd">{{ cases.case_note }}</td>
                    <td style="text-align: center;vertical-align: middle">
                        <div class="model link">
                            {#                            <a href="delete_case/{{ cases.id }}" class="btn btn-xs btn-danger" data-toggle="modal" data-target="#delete_case">删除</a>#}
                            <a href="update_case/{{ cases.id }}" class="btn btn-xs btn-warning" data-toggle="modal" data-target="#update_case">修改</a>
                        </div>
                    </td>
                    <td style="text-align: center;vertical-align: middle">{% if cases.test_plan_pic_path %}
                        <a href="{{ MEDIA_URL }}{{ cases.test_plan_pic_path }}" target="_blank">查看</a>
                    {% endif %}</td>
                {% endfor %}

                </tbody>
            </table>
             </div><!-- /.row -->
        </div>
        <nav aria-label="Page navigation">
            <ul class="pagination">
                {% if case_list.has_previous %}
                    <li>
                        <a href="?page={{ case_list.previous_page_number }}" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                {% endif %}

                {#                    {% for pg in case_list.paginator.page_range %}#}
                {#                                            {% circle_page case_list.number pg %}#}
                {#                        {% if case_list.number == pg %}#}
                {#                            <li class="active"><a href="?page={{ pg }}">{{ pg }}</a></li>#}
                {#                        {% else %}#}
                {#                            <li><a href="?page={{ pg }}">{{ pg }}</a></li>#}
                {#                        {% endif %}#}
                {#                    {% endfor %}#}

                {% for num in dis_range %}
                    {% if case_list.number == num %}
                        <li class="active" ><a href="?page={{ num }}">{{ num }}</a></li>
                    {% else %}
                        <li><a href="?page={{ num }}">{{ num }}</a></li>
                    {% endif %}

                {% endfor %}

                {% if case_list.has_next %}
                    <li>
                        <a href="?page={{ case_list.next_page_number }}" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                {% endif %}
                <br>
                <br>
                <nav aria-label="Page navigation">
                    <h4>选择跳转页:</h4><select class="form-control" style="width: 73px" name="topage" onchange="window.open('?page='+this.options[this.selectedIndex].value,'_self')">
                    {% for i in page_sumrange %}
                        {% if i == case_list.number %}
                            <option value={{ i }} selected>{{ i }}</option>
                        {% else %}
                            <option value={{ i }} >{{ i }}</option>
                        {% endif %}
                    {% endfor %}

                </select>
                </nav>
            </ul>

        </nav>



        <!-- 模态框（Modal） -->
        <div class="modal fade" id="delete_case" tabindex="-1" role="dialog" aria-labelledby="delete_caselable" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
        <div class="modal fade" id="update_case" tabindex="-1" role="dialog" aria-labelledby="update_caseLabel" aria-hidden="true">
            <div class="modal-dialog" style="width:700px">
                <div class="modal-content">
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
        <div class="modal fade" id="case_moreinfo" tabindex="-1" role="dialog" aria-labelledby="case_moreinfoLabel" aria-hidden="true">
            <div class="modal-dialog" style="width:700px">
                <div class="modal-content">
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
        <script>
            {#模态框#}
            $(function() {
                {#模态框#}
                $('#link .mymodel').modal('toggle')
            })
        </script>
        <script>
            {# 关闭窗口时刷新页面以便重新加载js#}
            $(function () { $('#delete_case').on('hide.bs.modal', function () {
                window.location.reload();
            })
            });
            $(function () { $('#update_case').on('hide.bs.modal', function () {
                window.location.reload();
            })
            });
            $(function () { $('#case_moreinfo').on('hide.bs.modal', function () {
                window.location.reload();
            })
            });
        </script>
    {% else %}
        <a href="/login/"><h1>please login!</h1></a>
    {% endif %}

{% endblock %}

<!-- forloop.counter -->