{% extends 'index.html' %}
{% block page-content %}

    <title>Project stage</title>
    <style>
        body {
            background-color: #eeedef;
            padding-right:0!important;
        }
        table{
            table-layout: auto;
        }
    </style>


    <p>{% if user.is_authenticated %}
        {#        <div class="panel panel-primary ">#}
        {#            <div class="panel-heading">#}
        <h2>{{ pj.project_name }}'s bug list</h2>
        <button type=button id="id_hide" class="btn pull-right">隐藏</button>
        <input class="btn btn-success pull-right" type="button" name="Submit" onclick="javascript:history.back(-1);" value="返回">
        <button class="btn btn-success pull-right" type="button"
                onclick="window.location.href='{% url 'add_issue' pj.id %}'">新增
        </button>
        {#            </div>#}
        <div class="panel-body">

            <table class = "table table-striped table-bordered" id="issue_table">

                <thead class="">
                <tr>
                    <th bgcolor="#0044cc" style="color: white">bug_id</th>
                    <th bgcolor="#0044cc" style="color: white">TRID</th>
                    <th bgcolor="#0044cc" style="color: white">bugzilla</th>
                    <th bgcolor="#0044cc" style="color: white">category</th>
                    <th bgcolor="#0044cc" style="color: white">attribute</th>
                    <th bgcolor="#0044cc" style="color: white">attribute_name</th>
                    <th bgcolor="#0044cc" style="color: white">severity</th>
                    <th bgcolor="#0044cc" style="color: white">description</th>
                    <th bgcolor="#0044cc" style="color: white">procedure</th>
                    <th bgcolor="#0044cc" style="color: white">comment</th>
                    <th bgcolor="#0044cc" style="color: white">root_cause</th>
                    <th bgcolor="#0044cc" style="color: white">solution</th>
                    <th bgcolor="#0044cc" style="color: white">status</th>
                    <th bgcolor="#0044cc" style="color: white">solving_type</th>
                    <th bgcolor="#0044cc" style="color: white">open_date</th>
                    <th bgcolor="#0044cc" style="color: white">verify_date</th>
                    <th bgcolor="#0044cc" style="color: white">close_date</th>
                    <th bgcolor="#0044cc" style="color: white">owner</th>
                    <th bgcolor="#0044cc" style="color: white">motherboard_version</th>
                    <th bgcolor="#0044cc" style="color: white">bios_version</th>
                    <th bgcolor="#0044cc" style="color: white">os_version</th>
                    <th bgcolor="#0044cc" style="color: white">remark</th>
                    <th bgcolor="#0044cc" style="color: white">submitter</th>
                </tr>
                </thead>
                <tbody>
                {% for i in issue_list %}

                    <tr>
                        <td><a href="{% url 'issue_update' pj.id i.id %}">{{ i.issue_id }} <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></td>
                        <td>{{ i.TRID }}</td>
                        <td>{{ i.bugzilla_id }}</td>
                        <td>{{ i.category }}</td>
                        <td>{{ i.attribute }}</td>
                        <td>{{ i.attribute_name }}</td>
                        <td>{{ i.severity }}</td>
                        <td>{{ i.description }}</td>
                        <td>{{ i.procedure }}</td>
                        <td>{{ i.comment }}</td>
                        <td>{{ i.root_cause }}</td>
                        <td>{{ i.solution }}</td>
                        {% if i.status == "closed" %}
                            <td id="id_closed" class="closed_class">{{ i.status }}</td>
                        {% else %}
                            <td>{{ i.status }}</td>
                        {% endif %}
                        <td>{{ i.solving_type }}</td>
                        <td>{{ i.open_date | date:'Y-m-d' }}</td>
                        <td>{{ i.verify_date | date:'Y-m-d' }}</td>
                        <td>{{ i.close_date | date:'Y-m-d' }}</td>
                        <td>{{ i.owner }}</td>
                        <td>{{ i.motherboard_version }}</td>
                        <td>{{ i.bios_version }}</td>
                        <td>{{ i.os_version }}</td>
                        <td>{{ i.remark }}</td>
                        <td>{{ i.submitter }}</td>
                    </tr>
                {% endfor %}
        </tbody>
        </table>
        </div>
        <script>
            $(document).ready(function(){
                $(".closed_class").parent().css('background-color', '#9c9c9c')
            });
            $("button#id_hide").click(function(){
                $(".closed_class").parent().toggle(500)
            });
        </script>

    {% else %}
        <a href="/login/"><h1>please login!</h1></a>
    {% endif %}
    <br><br>
{% endblock %}

</html>